"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[275],{3905:(e,n,t)=>{t.d(n,{Zo:()=>y,kt:()=>g});var r=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var s=r.createContext({}),c=function(e){var n=r.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},y=function(e){var n=c(e.components);return r.createElement(s.Provider,{value:n},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},d=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,y=i(e,["components","mdxType","originalType","parentName"]),u=c(t),d=o,g=u["".concat(s,".").concat(d)]||u[d]||p[d]||a;return t?r.createElement(g,l(l({ref:n},y),{},{components:t})):r.createElement(g,l({ref:n},y))}));function g(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,l=new Array(a);l[0]=d;var i={};for(var s in n)hasOwnProperty.call(n,s)&&(i[s]=n[s]);i.originalType=e,i[u]="string"==typeof e?e:o,l[1]=i;for(var c=2;c<a;c++)l[c]=t[c];return r.createElement.apply(null,l)}return r.createElement.apply(null,t)}d.displayName="MDXCreateElement"},9640:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>l,default:()=>p,frontMatter:()=>a,metadata:()=>i,toc:()=>c});var r=t(7462),o=(t(7294),t(3905));const a={sidebar_position:2},l="Managing Relays Connection",i={unversionedId:"usage/relays-and-events/connecting-to-relays",id:"usage/relays-and-events/connecting-to-relays",title:"Managing Relays Connection",description:"Connecting To Relays",source:"@site/docs/usage/relays-and-events/connecting-to-relays.md",sourceDirName:"usage/relays-and-events",slug:"/usage/relays-and-events/connecting-to-relays",permalink:"/nostr/usage/relays-and-events/connecting-to-relays",draft:!1,editUrl:"https://github.com/anasfik/nostr/tree/main/docs/docs/usage/relays-and-events/connecting-to-relays.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Creating Events",permalink:"/nostr/usage/relays-and-events/creating-events"},next:{title:"Listening & subscribe to events",permalink:"/nostr/usage/relays-and-events/listening-to-events"}},s={},c=[{value:"Connecting To Relays",id:"connecting-to-relays",level:2},{value:"Reconneting to relays",id:"reconneting-to-relays",level:2},{value:"Disconnecting from relays",id:"disconnecting-from-relays",level:2}],y={toc:c},u="wrapper";function p(e){let{components:n,...t}=e;return(0,o.kt)(u,(0,r.Z)({},y,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"managing-relays-connection"},"Managing Relays Connection"),(0,o.kt)("h2",{id:"connecting-to-relays"},"Connecting To Relays"),(0,o.kt)("p",null,"Now you have your relays up and running, and you have your events ready to be sent to them, but how can you send them to your relays?"),(0,o.kt)("p",null,"Before sending any event to your relays, you will need to initialize/connect to your them at least one time in your Dart/Flutter app before sending any event."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-dart"},"// TODO: add the code here.\n")),(0,o.kt)("p",null,"if you have a Flutter app, I personally recommend you to call this method in the ",(0,o.kt)("inlineCode",{parentName:"p"},"main()")," before the ",(0,o.kt)("inlineCode",{parentName:"p"},"runApp")," is called, so you ensure that the relays are connected before the app starts."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-dart"},'void main() async {\n  await Nostr.instance.relaysService.init(\n    relaysUrl: <String>["wss://eden.nostr.land"],\n    connectionTimeout: Duration(seconds: 5),\n    ensureToClearRegistriesBeforeStarting: true,\n    ignoreConnectionException: true,\n    lazyListeningToRelays: false,\n    onRelayConnectionDone: (relayUrl, relayWebSocket) {\n      print("Connected to relay: $relayUrl");\n    },\n    onRelayListening: (relayUrl, receivedEvent, relayWebSocket) {\n      print("Listening to relay: $relayUrl");\n    },\n    onRelayConnectionError: (relayUrl, error, relayWebSocket) {},\n    retryOnClose: true,\n    retryOnError: true,\n    shouldReconnectToRelayOnNotice: true,\n);\n\n// ...\n\n// if it is a flutter app:\n// runApp(MyApp());\n }\n')),(0,o.kt)("h2",{id:"reconneting-to-relays"},"Reconneting to relays"),(0,o.kt)("p",null,"if you already connected to your relays, and you want to reconnect to them again, you can call the ",(0,o.kt)("inlineCode",{parentName:"p"},"reconnectToRelays()")," method:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-dart"},'await Nostr.instance.relaysService.reconnectToRelays(\n  connectionTimeout: Duration(seconds: 5),\n  ignoreConnectionException: true,\n  lazyListeningToRelays: false,\n  onRelayConnectionDone: (relayUrl, relayWebSocket) {\n    print("Connected to relay: $relayUrl");\n  },\n  onRelayListening: (relayUrl, receivedEvent, relayWebSocket) {\n    print("Listening to relay: $relayUrl");\n  },\n  onRelayConnectionError: (relayUrl, error, relayWebSocket) {},\n  retryOnClose: true,\n  retryOnError: true,\n  shouldReconnectToRelayOnNotice: true,\n);\n')),(0,o.kt)("h2",{id:"disconnecting-from-relays"},"Disconnecting from relays"),(0,o.kt)("p",null,"if you want to disconnect from your relays, you can call the ",(0,o.kt)("inlineCode",{parentName:"p"},"disconnectFromRelays()")," method:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-dart"},'await Nostr.instance.relaysService.disconnectFromRelays(\n  closeCode: (relayUrl) {\n    return WebSocketStatus.normalClosure;\n  },\n  closeReason: (relayUrl) {\n    return "Bye";\n  },\n  onRelayDisconnect: (relayUrl, relayWebSocket, returnedMessage) {\n    print("Disconnected from relay: $relayUrl, $returnedMessage");\n  },\n);\n\n')))}p.isMDXComponent=!0}}]);